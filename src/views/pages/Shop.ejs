<section id="page-header">
  <h2>#stayhome</h2>
  <p><b>Save more with our 70% off!</b> </p>
</section>

<div id="product1" class="section-p1">
  <h2>Our Products</h2>
  <p>Summer Collection New Modern Design</p>
  <div class="test">
    <div class="pro-container" id="container">

      <% for (index=0; index < ProductModel.results.length; index++) { %>

        <div class="pro">
          <form id="prodForm" action="/product-page" method="GET">
            <button style="border: none;"><img src="<%= ProductModel.results[index].image %>" alt=""></button>
            <input type="hidden" name="id" value="<%= ProductModel.results[index].id %>">
          </form>
          <div class="des">
            <span>
              <%=ProductModel.results[index].brand.name %>
            </span>
            &nbsp<span>
              <%=ProductModel.results[index].category.name %>
            </span><br>
            <h5>
              <%= ProductModel.results[index].Product_name %>
            </h5>
            <div id="rating">
              <% for (rat=0; rat < ProductModel.results[index].rating; rat++) { %>
                <span class="star">
                  <i class="fas fa-start"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                      fill="currentColor" class="bi bi-star-fill" viewBox="0 0 16 16">
                      <path
                        d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z" />
                    </svg>
                  </i>
                </span>
                <% } %>
            </div>
            <h4><b>$<%=ProductModel.results[index].price %></b></h4>
          </div>
          <form id="Myform">
            <input type="hidden" name="productId" value="<%- ProductModel.results[index]._id %>">
            <button id="add-to-cart" type="submit" class="fal fa-shopping-cart cart"><svg
                xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                <path
                  d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .49.598l-1 5a.5.5 0 0 1-.465.401l-9.397.472L4.415 11H13a.5.5 0 0 1 0 1H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l.84 4.479 9.144-.459L13.89 4H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z" />
              </svg>
            </button>
          </form>
        </div>
        <% } %>
    </div>
  </div>
</div>

<div class="pagination" style="margin-left: 37%;">
  <li class="page-item previous-page" id="previous"><a class="page-link">Prev</a></li>
  <li class="page-item current-page active" id="1"><a class="page-link">1</a></li>
  <li class="page-item current-page" id="2"><a class="page-link">2</a></li>
  <li class="page-item current-page" id="3"><a class="page-link">3</a></li>
  <li class="page-item current-page" id="4"><a class="page-link">4</a></li>
  <li class="page-item current-page" id="5"><a class="page-link">5</a></li>
  <li class="page-item current-page" id="6"><a class="page-link">6</a></li>
  <li class="page-item next-page" id="next"><a class="page-link">Next</a></li>
</div>


<script type="text/javascript">
  var current_page = 1;

  $(document).on('click', "form#Myform", function (e) {
    "<% if(typeof user  === 'undefined'){ %>"
    window.location.href = "/login";
    "<% }else{ %>"
    e.preventDefault();
    $.ajax({
      url: "/add-to-cart",
      data: $(this).serialize(),
      type: 'POST',
      success: function (data) {
        $('.notification').load(" .notification");
      }
    });
    "<% } %>"
  });


  $(document).on('click', "#next", function () {
    if (current_page < 6) {
      $.ajax({
        url: "/shop?page=" + (++current_page) + "&limit=12",
        type: 'GET',
        success: function (data) {
          $(".pro-container").load("/shop?page=" + (current_page) + "&limit=12" + " .pro-container");
          $("#"+current_page).addClass("active");
          $("#"+(current_page-1)).removeClass("active");
        }
      });
    }
  })

  $(document).on('click', "#previous", function () {
    if (current_page > 1) {
      $.ajax({
        url: "/shop?page=" + (--current_page) + "&limit=12",
        type: 'GET',
        success: function (data) {
          $(".pro-container").load("/shop?page=" + (current_page) + "&limit=12" + " .pro-container");
          $("#"+current_page).addClass("active");
          $("#"+(current_page+1)).removeClass("active");
        }
      });
    }
  });

  $("#1").click(function () {
    $.ajax({
      url: "/shop?page=1&limit=12",
      type: 'GET',
      success: function (data) {
        current_page = 1;
        $("#1").addClass("active");
        $("#2").removeClass("active");
        $("#3").removeClass("active");
        $("#4").removeClass("active");
        $("#5").removeClass("active");
        $("#6").removeClass("active");
        $(".pro-container").load("/shop?page=1&limit=12 .pro-container");
      }
    });
  });
  $("#2").click(function () {
    $.ajax({
      url: "/shop?page=2&limit=12",
      type: 'GET',
      success: function (data) {
        current_page = 2;
        $("#2").addClass("active");
        $("#1").removeClass("active");
        $("#3").removeClass("active");
        $("#4").removeClass("active");
        $("#5").removeClass("active");
        $("#6").removeClass("active");
        $(".pro-container").load("/shop?page=2&limit=12 .pro-container");
      }
    });
  });
  $("#3").click(function () {
    $.ajax({
      url: "/shop?page=3&limit=12",
      type: 'GET',
      success: function (data) {
        current_page = 3;
        $("#3").addClass("active");
        $("#2").removeClass("active");
        $("#1").removeClass("active");
        $("#4").removeClass("active");
        $("#5").removeClass("active");
        $("#6").removeClass("active");
        $(".pro-container").load("/shop?page=3&limit=12 .pro-container");
      }
    });
  });
  $("#4").click(function () {
    $.ajax({
      url: "/shop?page=4&limit=12",
      type: 'GET',
      success: function (data) {
        current_page = 4;
        $("#4").addClass("active");
        $("#2").removeClass("active");
        $("#3").removeClass("active");
        $("#1").removeClass("active");
        $("#5").removeClass("active");
        $("#6").removeClass("active");
        $(".pro-container").load("/shop?page=4&limit=12 .pro-container");
      }
    });
  });
  $("#5").click(function () {
    $.ajax({
      url: "/shop?page=5&limit=12",
      type: 'GET',
      success: function (data) {
        current_page = 5;
        $("#5").addClass("active");
        $("#2").removeClass("active");
        $("#3").removeClass("active");
        $("#4").removeClass("active");
        $("#1").removeClass("active");
        $("#6").removeClass("active");
        $(".pro-container").load("/shop?page=5&limit=12 .pro-container");
      }
    });
  });
  $("#6").click(function () {
    $.ajax({
      url: "/shop?page=6&limit=12",
      type: 'GET',
      success: function (data) {
        current_page = 6;
        $("#6").addClass("active");
        $("#2").removeClass("active");
        $("#3").removeClass("active");
        $("#4").removeClass("active");
        $("#5").removeClass("active");
        $("#1").removeClass("active");
        $(".pro-container").load("/shop?page=6&limit=12 .pro-container");
      }
    });
  });
</script>